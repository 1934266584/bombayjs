{"code":"import { Config } from '../config';\r\nimport { randomString, } from './tools';\r\nimport { GlobalVal } from '../config/global';\r\nexport function getCommonMsg() {\r\n    var u = navigator.connection;\r\n    var data = {\r\n        t: '',\r\n        page: getPage(),\r\n        times: 1,\r\n        v: Config.appVersion,\r\n        token: Config.token,\r\n        e: Config.environment,\r\n        begin: new Date().getTime(),\r\n        uid: getUid(),\r\n        sid: GlobalVal.sid,\r\n        sr: screen.width + \"x\" + screen.height,\r\n        vp: getScreen(),\r\n        ct: u ? u.effectiveType : '',\r\n        ul: getLang(),\r\n        _v: '{{VERSION}}',\r\n        o: location.href,\r\n    };\r\n    return data;\r\n}\r\n// 获取页面\r\nfunction getPage() {\r\n    if (GlobalVal.page)\r\n        return GlobalVal.page;\r\n    else {\r\n        return location.pathname.toLowerCase();\r\n    }\r\n}\r\n// 获取uid\r\nfunction getUid() {\r\n    var uid = localStorage.getItem('bombay_uid') || '';\r\n    if (!uid) {\r\n        uid = randomString();\r\n        localStorage.setItem('bombay_uid', uid);\r\n    }\r\n    return uid;\r\n}\r\n// 获得sid\r\n// TODO: 单页面\r\n// function getSid() {\r\n//   const date = new Date();\r\n//   let sid = sessionStorage.getItem('bombay_sid') || '';\r\n//   if (!sid) {\r\n//       sid = randomString();\r\n//       sessionStorage.setItem('bombay_sid', sid);\r\n//   }\r\n//   return sid;\r\n// }\r\n// 获取浏览器默认语言\r\nfunction getLang() {\r\n    var lang = navigator.language || navigator.userLanguage; //常规浏览器语言和IE浏览器\r\n    lang = lang.substr(0, 2); //截取lang前2位字符\r\n    return lang;\r\n}\r\nfunction getScreen() {\r\n    var w = document.documentElement.clientWidth || document.body.clientWidth;\r\n    var h = document.documentElement.clientHeight || document.body.clientHeight;\r\n    return w + 'x' + h;\r\n}\r\n//# sourceMappingURL=index.js.map","references":["/Users/jing/zoomlion/错误收集前端页面采集代码/src/config/index.ts","/Users/jing/zoomlion/错误收集前端页面采集代码/src/utils/tools.ts","/Users/jing/zoomlion/错误收集前端页面采集代码/src/config/global.ts"],"map":"{\"version\":3,\"file\":\"index.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../src/utils/index.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,EAAC,MAAM,EAAC,MAAM,WAAW,CAAA;AAChC,OAAO,EAAC,YAAY,GAAc,MAAM,SAAS,CAAA;AACjD,OAAO,EAAE,SAAS,EAAE,MAAM,kBAAkB,CAAA;AAE5C,MAAM,UAAU,YAAY;IAC1B,IAAI,CAAC,GAAI,SAAiB,CAAC,UAAU,CAAA;IACrC,IAAI,IAAI,GAAc;QACpB,CAAC,EAAE,EAAE;QACL,IAAI,EAAE,OAAO,EAAE;QACf,KAAK,EAAE,CAAC;QACR,CAAC,EAAE,MAAM,CAAC,UAAU;QACpB,KAAK,EAAE,MAAM,CAAC,KAAK;QACnB,CAAC,EAAE,MAAM,CAAC,WAAW;QACrB,KAAK,EAAE,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE;QAC3B,GAAG,EAAE,MAAM,EAAE;QACb,GAAG,EAAE,SAAS,CAAC,GAAG;QAClB,EAAE,EAAE,MAAM,CAAC,KAAK,GAAG,GAAG,GAAG,MAAM,CAAC,MAAM;QACtC,EAAE,EAAE,SAAS,EAAE;QACf,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,EAAE;QAC5B,EAAE,EAAE,OAAO,EAAE;QACb,EAAE,EAAE,aAAa;QACjB,CAAC,EAAE,QAAQ,CAAC,IAAI;KACjB,CAAA;IACD,OAAO,IAAI,CAAA;AACb,CAAC;AAED,OAAO;AACP,SAAS,OAAO;IACd,IAAI,SAAS,CAAC,IAAI;QAAE,OAAO,SAAS,CAAC,IAAI,CAAA;SACpC;QACH,OAAO,QAAQ,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAA;KACvC;AACH,CAAC;AAED,QAAQ;AACR,SAAS,MAAM;IACb,IAAI,GAAG,GAAG,YAAY,CAAC,OAAO,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC;IACnD,IAAI,CAAC,GAAG,EAAE;QACR,GAAG,GAAG,YAAY,EAAE,CAAC;QACrB,YAAY,CAAC,OAAO,CAAC,YAAY,EAAE,GAAG,CAAC,CAAC;KACzC;IACD,OAAO,GAAG,CAAC;AACb,CAAC;AAED,QAAQ;AACR,YAAY;AACZ,sBAAsB;AACtB,6BAA6B;AAC7B,0DAA0D;AAC1D,gBAAgB;AAChB,8BAA8B;AAC9B,mDAAmD;AACnD,MAAM;AACN,gBAAgB;AAChB,IAAI;AAEJ,YAAY;AACZ,SAAS,OAAO;IACd,IAAI,IAAI,GAAG,SAAS,CAAC,QAAQ,IAAK,SAAiB,CAAC,YAAY,CAAC,CAAC,eAAe;IACjF,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,aAAa;IACvC,OAAO,IAAI,CAAA;AACb,CAAC;AAED,SAAS,SAAS;IAChB,IAAI,CAAC,GAAG,QAAQ,CAAC,eAAe,CAAC,WAAW,IAAI,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC;IAC1E,IAAI,CAAC,GAAG,QAAQ,CAAC,eAAe,CAAC,YAAY,IAAI,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC;IAC5E,OAAO,CAAC,GAAG,GAAG,GAAG,CAAC,CAAA;AACpB,CAAC\"}"}

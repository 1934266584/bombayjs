{"code":"import { Config, } from './config';\r\nimport { serialize, warn } from './utils/tools';\r\n// 上报\r\nexport function report(e) {\r\n    \"res\" === e.t ?\r\n        send(e)\r\n        : \"error\" === e.t ? send(e)\r\n            : \"behavior\" === e.t ? send(e)\r\n                : \"health\" === e.t && window && window.navigator && \"function\" == typeof window.navigator.sendBeacon ? sendBeacon(e)\r\n                    : send(e);\r\n    return this;\r\n}\r\n// post上报\r\nexport function send(msg) {\r\n    var _a;\r\n    var body = msg[msg.t];\r\n    delete msg[msg.t];\r\n    var url = Config.reportUrl + \"?\" + serialize(msg);\r\n    post(url, (_a = {},\r\n        _a[msg.t] = body,\r\n        _a));\r\n    // new Image().src = `${Config.reportUrl}?${serialize(msg)}`\r\n}\r\nexport function post(url, body) {\r\n    var XMLHttpRequest = window.__oXMLHttpRequest_ || window.XMLHttpRequest;\r\n    if (typeof XMLHttpRequest === 'function') {\r\n        try {\r\n            var xhr = new XMLHttpRequest();\r\n            xhr.open(\"POST\", url, !0);\r\n            xhr.setRequestHeader(\"Content-Type\", \"text/plain\");\r\n            xhr.send(JSON.stringify(body));\r\n        }\r\n        catch (e) {\r\n            warn('[bombayjs] Failed to log, POST请求失败');\r\n        }\r\n    }\r\n    else {\r\n        warn('[bombayjs] Failed to log, 浏览器不支持XMLHttpRequest');\r\n    }\r\n}\r\n// 健康检查上报\r\nexport function sendBeacon(e) {\r\n    \"object\" == typeof e && (e = serialize(e));\r\n    e = Config.reportUrl + \"?\" + e;\r\n    window && window.navigator && \"function\" == typeof window.navigator.sendBeacon\r\n        ? window.navigator.sendBeacon(e)\r\n        : warn(\"[arms] navigator.sendBeacon not surported\");\r\n}\r\n//# sourceMappingURL=reporter.js.map","references":["/Users/jing/zoomlion/错误收集前端页面采集代码/src/config/index.ts","/Users/jing/zoomlion/错误收集前端页面采集代码/src/utils/tools.ts"],"map":"{\"version\":3,\"file\":\"reporter.js\",\"sourceRoot\":\"\",\"sources\":[\"../../src/reporter.ts\"],\"names\":[],\"mappings\":\"AACA,OAAO,EAAE,MAAM,GAAG,MAAM,UAAU,CAAA;AAClC,OAAO,EAAe,SAAS,EAAE,IAAI,EAAE,MAAM,eAAe,CAAA;AAE5D,KAAK;AACL,MAAM,UAAU,MAAM,CAAC,CAAa;IAChC,KAAK,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;QACf,IAAI,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,OAAO,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;YAC3B,CAAC,CAAC,UAAU,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;gBAC9B,CAAC,CAAC,QAAQ,KAAK,CAAC,CAAC,CAAC,IAAI,MAAM,IAAI,MAAM,CAAC,SAAS,IAAI,UAAU,IAAI,OAAO,MAAM,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;oBACpH,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;IACd,OAAO,IAAI,CAAA;AACb,CAAC;AAED,SAAS;AACT,MAAM,UAAU,IAAI,CAAC,GAAe;;IAClC,IAAI,IAAI,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;IACrB,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;IACjB,IAAI,GAAG,GAAM,MAAM,CAAC,SAAS,SAAI,SAAS,CAAC,GAAG,CAAG,CAAA;IACjD,IAAI,CAAC,GAAG;QACN,GAAC,GAAG,CAAC,CAAC,IAAG,IAAI;YACb,CAAA;IACF,4DAA4D;AAC9D,CAAC;AAED,MAAM,UAAU,IAAI,CAAC,GAAG,EAAE,IAAI;IAC5B,IAAI,cAAc,GAAG,MAAM,CAAC,kBAAkB,IAAI,MAAM,CAAC,cAAc,CAAC;IACxE,IAAI,OAAO,cAAc,KAAK,UAAU,EAAE;QACxC,IAAI;YACF,IAAI,GAAG,GAAG,IAAI,cAAc,EAAE,CAAC;YAC/B,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC,CAAA;YACzB,GAAG,CAAC,gBAAgB,CAAC,cAAc,EAAE,YAAY,CAAC,CAAA;YAClD,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAA;SAC/B;QAAC,OAAO,CAAC,EAAE;YACV,IAAI,CAAC,oCAAoC,CAAC,CAAA;SAC3C;KACF;SAAM;QACL,IAAI,CAAC,gDAAgD,CAAC,CAAA;KACvD;AACH,CAAC;AAED,SAAS;AACT,MAAM,UAAU,UAAU,CAAC,CAAK;IAC9B,QAAQ,IAAI,OAAO,CAAC,IAAI,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3C,CAAC,GAAM,MAAM,CAAC,SAAS,SAAI,CAAG,CAAA;IAC9B,MAAM,IAAI,MAAM,CAAC,SAAS,IAAI,UAAU,IAAI,OAAO,MAAM,CAAC,SAAS,CAAC,UAAU;QAC5E,CAAC,CAAC,MAAM,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC;QAChC,CAAC,CAAC,IAAI,CAAC,2CAA2C,CAAC,CAAA;AACvD,CAAC\"}"}
